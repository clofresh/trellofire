{"version":3,"file":"main.js","sources":["peg/action.js","action.js","peg/query.js","stores/lists.js","query.js","stores/selected.js","views/trello_item!jsx","views/trello_group!jsx","views/query_bar!jsx","views/trello_board!jsx","app!jsx","util.js"],"names":[],"mappings":"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","sourcesContent":["var _action_parser = (function() {\n  /*\n   * Generated by PEG.js 0.8.0.\n   *\n   * http://pegjs.majda.cz/\n   */\n\n  function peg$subclass(child, parent) {\n    function ctor() { this.constructor = child; }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n  }\n\n  function SyntaxError(message, expected, found, offset, line, column) {\n    this.message  = message;\n    this.expected = expected;\n    this.found    = found;\n    this.offset   = offset;\n    this.line     = line;\n    this.column   = column;\n\n    this.name     = \"SyntaxError\";\n  }\n\n  peg$subclass(SyntaxError, Error);\n\n  function parse(input) {\n    var options = arguments.length > 1 ? arguments[1] : {},\n\n        peg$FAILED = {},\n\n        peg$startRuleFunctions = { start: peg$parsestart },\n        peg$startRuleFunction  = peg$parsestart,\n\n        peg$c0 = peg$FAILED,\n        peg$c1 = [],\n        peg$c2 = /^[ ]/,\n        peg$c3 = { type: \"class\", value: \"[ ]\", description: \"[ ]\" },\n        peg$c4 = null,\n        peg$c5 = function(head, tail) {\n             var vals = [head];\n             if (tail === null) {\n                 return vals;\n             } else {\n                 return vals.concat(tail);\n             }\n        },\n        peg$c6 = \":\",\n        peg$c7 = { type: \"literal\", value: \":\", description: \"\\\":\\\"\" },\n        peg$c8 = function(f, value) { return {field: f, value: value} },\n        peg$c9 = \"title\",\n        peg$c10 = { type: \"literal\", value: \"title\", description: \"\\\"title\\\"\" },\n        peg$c11 = \"\\\"\",\n        peg$c12 = { type: \"literal\", value: \"\\\"\", description: \"\\\"\\\\\\\"\\\"\" },\n        peg$c13 = /^[^\"]/,\n        peg$c14 = { type: \"class\", value: \"[^\\\"]\", description: \"[^\\\"]\" },\n        peg$c15 = function(val) { return strconcat(val) },\n        peg$c16 = /^[^ ]/,\n        peg$c17 = { type: \"class\", value: \"[^ ]\", description: \"[^ ]\" },\n\n        peg$currPos          = 0,\n        peg$reportedPos      = 0,\n        peg$cachedPos        = 0,\n        peg$cachedPosDetails = { line: 1, column: 1, seenCR: false },\n        peg$maxFailPos       = 0,\n        peg$maxFailExpected  = [],\n        peg$silentFails      = 0,\n\n        peg$result;\n\n    if (\"startRule\" in options) {\n      if (!(options.startRule in peg$startRuleFunctions)) {\n        throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n      }\n\n      peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n    }\n\n    function text() {\n      return input.substring(peg$reportedPos, peg$currPos);\n    }\n\n    function offset() {\n      return peg$reportedPos;\n    }\n\n    function line() {\n      return peg$computePosDetails(peg$reportedPos).line;\n    }\n\n    function column() {\n      return peg$computePosDetails(peg$reportedPos).column;\n    }\n\n    function expected(description) {\n      throw peg$buildException(\n        null,\n        [{ type: \"other\", description: description }],\n        peg$reportedPos\n      );\n    }\n\n    function error(message) {\n      throw peg$buildException(message, null, peg$reportedPos);\n    }\n\n    function peg$computePosDetails(pos) {\n      function advance(details, startPos, endPos) {\n        var p, ch;\n\n        for (p = startPos; p < endPos; p++) {\n          ch = input.charAt(p);\n          if (ch === \"\\n\") {\n            if (!details.seenCR) { details.line++; }\n            details.column = 1;\n            details.seenCR = false;\n          } else if (ch === \"\\r\" || ch === \"\\u2028\" || ch === \"\\u2029\") {\n            details.line++;\n            details.column = 1;\n            details.seenCR = true;\n          } else {\n            details.column++;\n            details.seenCR = false;\n          }\n        }\n      }\n\n      if (peg$cachedPos !== pos) {\n        if (peg$cachedPos > pos) {\n          peg$cachedPos = 0;\n          peg$cachedPosDetails = { line: 1, column: 1, seenCR: false };\n        }\n        advance(peg$cachedPosDetails, peg$cachedPos, pos);\n        peg$cachedPos = pos;\n      }\n\n      return peg$cachedPosDetails;\n    }\n\n    function peg$fail(expected) {\n      if (peg$currPos < peg$maxFailPos) { return; }\n\n      if (peg$currPos > peg$maxFailPos) {\n        peg$maxFailPos = peg$currPos;\n        peg$maxFailExpected = [];\n      }\n\n      peg$maxFailExpected.push(expected);\n    }\n\n    function peg$buildException(message, expected, pos) {\n      function cleanupExpected(expected) {\n        var i = 1;\n\n        expected.sort(function(a, b) {\n          if (a.description < b.description) {\n            return -1;\n          } else if (a.description > b.description) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n        while (i < expected.length) {\n          if (expected[i - 1] === expected[i]) {\n            expected.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n      }\n\n      function buildMessage(expected, found) {\n        function stringEscape(s) {\n          function hex(ch) { return ch.charCodeAt(0).toString(16).toUpperCase(); }\n\n          return s\n            .replace(/\\\\/g,   '\\\\\\\\')\n            .replace(/\"/g,    '\\\\\"')\n            .replace(/\\x08/g, '\\\\b')\n            .replace(/\\t/g,   '\\\\t')\n            .replace(/\\n/g,   '\\\\n')\n            .replace(/\\f/g,   '\\\\f')\n            .replace(/\\r/g,   '\\\\r')\n            .replace(/[\\x00-\\x07\\x0B\\x0E\\x0F]/g, function(ch) { return '\\\\x0' + hex(ch); })\n            .replace(/[\\x10-\\x1F\\x80-\\xFF]/g,    function(ch) { return '\\\\x'  + hex(ch); })\n            .replace(/[\\u0180-\\u0FFF]/g,         function(ch) { return '\\\\u0' + hex(ch); })\n            .replace(/[\\u1080-\\uFFFF]/g,         function(ch) { return '\\\\u'  + hex(ch); });\n        }\n\n        var expectedDescs = new Array(expected.length),\n            expectedDesc, foundDesc, i;\n\n        for (i = 0; i < expected.length; i++) {\n          expectedDescs[i] = expected[i].description;\n        }\n\n        expectedDesc = expected.length > 1\n          ? expectedDescs.slice(0, -1).join(\", \")\n              + \" or \"\n              + expectedDescs[expected.length - 1]\n          : expectedDescs[0];\n\n        foundDesc = found ? \"\\\"\" + stringEscape(found) + \"\\\"\" : \"end of input\";\n\n        return \"Expected \" + expectedDesc + \" but \" + foundDesc + \" found.\";\n      }\n\n      var posDetails = peg$computePosDetails(pos),\n          found      = pos < input.length ? input.charAt(pos) : null;\n\n      if (expected !== null) {\n        cleanupExpected(expected);\n      }\n\n      return new SyntaxError(\n        message !== null ? message : buildMessage(expected, found),\n        expected,\n        found,\n        pos,\n        posDetails.line,\n        posDetails.column\n      );\n    }\n\n    function peg$parsestart() {\n      var s0;\n\n      s0 = peg$parsequery();\n\n      return s0;\n    }\n\n    function peg$parsequery() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      s1 = peg$parseterm();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c2.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c3); }\n        }\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          if (peg$c2.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c3); }\n          }\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parsequery();\n          if (s3 === peg$FAILED) {\n            s3 = peg$c4;\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c5(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n\n      return s0;\n    }\n\n    function peg$parseterm() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      s1 = peg$parsefield();\n      if (s1 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 58) {\n          s2 = peg$c6;\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c7); }\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parsestring();\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c8(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n\n      return s0;\n    }\n\n    function peg$parsefield() {\n      var s0;\n\n      if (input.substr(peg$currPos, 5) === peg$c9) {\n        s0 = peg$c9;\n        peg$currPos += 5;\n      } else {\n        s0 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c10); }\n      }\n\n      return s0;\n    }\n\n    function peg$parsestring() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 34) {\n        s1 = peg$c11;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c12); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c13.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c14); }\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            if (peg$c13.test(input.charAt(peg$currPos))) {\n              s3 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c14); }\n            }\n          }\n        } else {\n          s2 = peg$c0;\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 34) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c15(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = [];\n        if (peg$c16.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c17); }\n        }\n        if (s2 !== peg$FAILED) {\n          while (s2 !== peg$FAILED) {\n            s1.push(s2);\n            if (peg$c16.test(input.charAt(peg$currPos))) {\n              s2 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s2 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c17); }\n            }\n          }\n        } else {\n          s1 = peg$c0;\n        }\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c15(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n\n        function strconcat(s) { return s.join(\"\") }\n\n\n    peg$result = peg$startRuleFunction();\n\n    if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n      return peg$result;\n    } else {\n      if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n        peg$fail({ type: \"end\", description: \"end of input\" });\n      }\n\n      throw peg$buildException(null, peg$maxFailExpected, peg$maxFailPos);\n    }\n  }\n\n  return {\n    SyntaxError: SyntaxError,\n    parse:       parse\n  };\n})();\ndefine('peg/action',[],function() { return _action_parser; });\n\n","define('action',[\"./peg/action\"], function(Parser) {\n  return {\n    parse: function(str) {\n      var output = {\n        fields: {}\n      };\n      var terms = Parser.parse(str);\n      for (var i = 0; i < terms.length; ++i) {\n        var term = terms[i];\n\n        var field = term.field;\n        var value = term.value;\n        switch (field) {\n          case \"title\":\n            output.fields[field] = value;\n            break;\n        }\n      }\n      output.terms = terms;\n      output.str = str;\n      return output;\n    }\n  };\n});\n\n","var _query_parser = (function() {\n  /*\n   * Generated by PEG.js 0.8.0.\n   *\n   * http://pegjs.majda.cz/\n   */\n\n  function peg$subclass(child, parent) {\n    function ctor() { this.constructor = child; }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n  }\n\n  function SyntaxError(message, expected, found, offset, line, column) {\n    this.message  = message;\n    this.expected = expected;\n    this.found    = found;\n    this.offset   = offset;\n    this.line     = line;\n    this.column   = column;\n\n    this.name     = \"SyntaxError\";\n  }\n\n  peg$subclass(SyntaxError, Error);\n\n  function parse(input) {\n    var options = arguments.length > 1 ? arguments[1] : {},\n\n        peg$FAILED = {},\n\n        peg$startRuleFunctions = { start: peg$parsestart },\n        peg$startRuleFunction  = peg$parsestart,\n\n        peg$c0 = peg$FAILED,\n        peg$c1 = [],\n        peg$c2 = /^[ ]/,\n        peg$c3 = { type: \"class\", value: \"[ ]\", description: \"[ ]\" },\n        peg$c4 = null,\n        peg$c5 = function(head, tail) {\n             var vals = [head];\n             if (tail === null) {\n                 return vals;\n             } else {\n                 return vals.concat(tail);\n             }\n        },\n        peg$c6 = \":\",\n        peg$c7 = { type: \"literal\", value: \":\", description: \"\\\":\\\"\" },\n        peg$c8 = function(uop, field, value) {\n             return {\n                 field: field,\n                 value: value,\n                 op:    uop\n             }\n         },\n        peg$c9 = function(field, value) { return {field: field, value: value} },\n        peg$c10 = \"board\",\n        peg$c11 = { type: \"literal\", value: \"board\", description: \"\\\"board\\\"\" },\n        peg$c12 = \"groupby\",\n        peg$c13 = { type: \"literal\", value: \"groupby\", description: \"\\\"groupby\\\"\" },\n        peg$c14 = \"sortdir\",\n        peg$c15 = { type: \"literal\", value: \"sortdir\", description: \"\\\"sortdir\\\"\" },\n        peg$c16 = \"sort\",\n        peg$c17 = { type: \"literal\", value: \"sort\", description: \"\\\"sort\\\"\" },\n        peg$c18 = \"title\",\n        peg$c19 = { type: \"literal\", value: \"title\", description: \"\\\"title\\\"\" },\n        peg$c20 = \"state\",\n        peg$c21 = { type: \"literal\", value: \"state\", description: \"\\\"state\\\"\" },\n        peg$c22 = \"\\\"\",\n        peg$c23 = { type: \"literal\", value: \"\\\"\", description: \"\\\"\\\\\\\"\\\"\" },\n        peg$c24 = /^[^\"]/,\n        peg$c25 = { type: \"class\", value: \"[^\\\"]\", description: \"[^\\\"]\" },\n        peg$c26 = function(val) { return strconcat(val) },\n        peg$c27 = /^[^ ]/,\n        peg$c28 = { type: \"class\", value: \"[^ ]\", description: \"[^ ]\" },\n        peg$c29 = \"!\",\n        peg$c30 = { type: \"literal\", value: \"!\", description: \"\\\"!\\\"\" },\n        peg$c31 = function() { return {type: \"unary\", name: \"not\"} },\n\n        peg$currPos          = 0,\n        peg$reportedPos      = 0,\n        peg$cachedPos        = 0,\n        peg$cachedPosDetails = { line: 1, column: 1, seenCR: false },\n        peg$maxFailPos       = 0,\n        peg$maxFailExpected  = [],\n        peg$silentFails      = 0,\n\n        peg$result;\n\n    if (\"startRule\" in options) {\n      if (!(options.startRule in peg$startRuleFunctions)) {\n        throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n      }\n\n      peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n    }\n\n    function text() {\n      return input.substring(peg$reportedPos, peg$currPos);\n    }\n\n    function offset() {\n      return peg$reportedPos;\n    }\n\n    function line() {\n      return peg$computePosDetails(peg$reportedPos).line;\n    }\n\n    function column() {\n      return peg$computePosDetails(peg$reportedPos).column;\n    }\n\n    function expected(description) {\n      throw peg$buildException(\n        null,\n        [{ type: \"other\", description: description }],\n        peg$reportedPos\n      );\n    }\n\n    function error(message) {\n      throw peg$buildException(message, null, peg$reportedPos);\n    }\n\n    function peg$computePosDetails(pos) {\n      function advance(details, startPos, endPos) {\n        var p, ch;\n\n        for (p = startPos; p < endPos; p++) {\n          ch = input.charAt(p);\n          if (ch === \"\\n\") {\n            if (!details.seenCR) { details.line++; }\n            details.column = 1;\n            details.seenCR = false;\n          } else if (ch === \"\\r\" || ch === \"\\u2028\" || ch === \"\\u2029\") {\n            details.line++;\n            details.column = 1;\n            details.seenCR = true;\n          } else {\n            details.column++;\n            details.seenCR = false;\n          }\n        }\n      }\n\n      if (peg$cachedPos !== pos) {\n        if (peg$cachedPos > pos) {\n          peg$cachedPos = 0;\n          peg$cachedPosDetails = { line: 1, column: 1, seenCR: false };\n        }\n        advance(peg$cachedPosDetails, peg$cachedPos, pos);\n        peg$cachedPos = pos;\n      }\n\n      return peg$cachedPosDetails;\n    }\n\n    function peg$fail(expected) {\n      if (peg$currPos < peg$maxFailPos) { return; }\n\n      if (peg$currPos > peg$maxFailPos) {\n        peg$maxFailPos = peg$currPos;\n        peg$maxFailExpected = [];\n      }\n\n      peg$maxFailExpected.push(expected);\n    }\n\n    function peg$buildException(message, expected, pos) {\n      function cleanupExpected(expected) {\n        var i = 1;\n\n        expected.sort(function(a, b) {\n          if (a.description < b.description) {\n            return -1;\n          } else if (a.description > b.description) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n        while (i < expected.length) {\n          if (expected[i - 1] === expected[i]) {\n            expected.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n      }\n\n      function buildMessage(expected, found) {\n        function stringEscape(s) {\n          function hex(ch) { return ch.charCodeAt(0).toString(16).toUpperCase(); }\n\n          return s\n            .replace(/\\\\/g,   '\\\\\\\\')\n            .replace(/\"/g,    '\\\\\"')\n            .replace(/\\x08/g, '\\\\b')\n            .replace(/\\t/g,   '\\\\t')\n            .replace(/\\n/g,   '\\\\n')\n            .replace(/\\f/g,   '\\\\f')\n            .replace(/\\r/g,   '\\\\r')\n            .replace(/[\\x00-\\x07\\x0B\\x0E\\x0F]/g, function(ch) { return '\\\\x0' + hex(ch); })\n            .replace(/[\\x10-\\x1F\\x80-\\xFF]/g,    function(ch) { return '\\\\x'  + hex(ch); })\n            .replace(/[\\u0180-\\u0FFF]/g,         function(ch) { return '\\\\u0' + hex(ch); })\n            .replace(/[\\u1080-\\uFFFF]/g,         function(ch) { return '\\\\u'  + hex(ch); });\n        }\n\n        var expectedDescs = new Array(expected.length),\n            expectedDesc, foundDesc, i;\n\n        for (i = 0; i < expected.length; i++) {\n          expectedDescs[i] = expected[i].description;\n        }\n\n        expectedDesc = expected.length > 1\n          ? expectedDescs.slice(0, -1).join(\", \")\n              + \" or \"\n              + expectedDescs[expected.length - 1]\n          : expectedDescs[0];\n\n        foundDesc = found ? \"\\\"\" + stringEscape(found) + \"\\\"\" : \"end of input\";\n\n        return \"Expected \" + expectedDesc + \" but \" + foundDesc + \" found.\";\n      }\n\n      var posDetails = peg$computePosDetails(pos),\n          found      = pos < input.length ? input.charAt(pos) : null;\n\n      if (expected !== null) {\n        cleanupExpected(expected);\n      }\n\n      return new SyntaxError(\n        message !== null ? message : buildMessage(expected, found),\n        expected,\n        found,\n        pos,\n        posDetails.line,\n        posDetails.column\n      );\n    }\n\n    function peg$parsestart() {\n      var s0;\n\n      s0 = peg$parsequery();\n\n      return s0;\n    }\n\n    function peg$parsequery() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      s1 = peg$parseterm();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c2.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c3); }\n        }\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          if (peg$c2.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c3); }\n          }\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parsequery();\n          if (s3 === peg$FAILED) {\n            s3 = peg$c4;\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c5(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n\n      return s0;\n    }\n\n    function peg$parseterm() {\n      var s0, s1, s2, s3, s4;\n\n      s0 = peg$currPos;\n      s1 = peg$parsenot();\n      if (s1 === peg$FAILED) {\n        s1 = peg$c4;\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsefilter();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 58) {\n            s3 = peg$c6;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c7); }\n          }\n          if (s3 !== peg$FAILED) {\n            s4 = peg$parsestring();\n            if (s4 !== peg$FAILED) {\n              peg$reportedPos = s0;\n              s1 = peg$c8(s1, s2, s4);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$c0;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseidentifier();\n        if (s1 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 58) {\n            s2 = peg$c6;\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c7); }\n          }\n          if (s2 !== peg$FAILED) {\n            s3 = peg$parsestring();\n            if (s3 !== peg$FAILED) {\n              peg$reportedPos = s0;\n              s1 = peg$c9(s1, s3);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$c0;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      }\n\n      return s0;\n    }\n\n    function peg$parseidentifier() {\n      var s0;\n\n      if (input.substr(peg$currPos, 5) === peg$c10) {\n        s0 = peg$c10;\n        peg$currPos += 5;\n      } else {\n        s0 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c11); }\n      }\n      if (s0 === peg$FAILED) {\n        if (input.substr(peg$currPos, 7) === peg$c12) {\n          s0 = peg$c12;\n          peg$currPos += 7;\n        } else {\n          s0 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c13); }\n        }\n        if (s0 === peg$FAILED) {\n          if (input.substr(peg$currPos, 7) === peg$c14) {\n            s0 = peg$c14;\n            peg$currPos += 7;\n          } else {\n            s0 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c15); }\n          }\n          if (s0 === peg$FAILED) {\n            if (input.substr(peg$currPos, 4) === peg$c16) {\n              s0 = peg$c16;\n              peg$currPos += 4;\n            } else {\n              s0 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c17); }\n            }\n            if (s0 === peg$FAILED) {\n              s0 = peg$parsefilter();\n            }\n          }\n        }\n      }\n\n      return s0;\n    }\n\n    function peg$parsefilter() {\n      var s0;\n\n      if (input.substr(peg$currPos, 5) === peg$c18) {\n        s0 = peg$c18;\n        peg$currPos += 5;\n      } else {\n        s0 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c19); }\n      }\n      if (s0 === peg$FAILED) {\n        if (input.substr(peg$currPos, 5) === peg$c20) {\n          s0 = peg$c20;\n          peg$currPos += 5;\n        } else {\n          s0 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c21); }\n        }\n      }\n\n      return s0;\n    }\n\n    function peg$parsestring() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 34) {\n        s1 = peg$c22;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c23); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c24.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c25); }\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            if (peg$c24.test(input.charAt(peg$currPos))) {\n              s3 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c25); }\n            }\n          }\n        } else {\n          s2 = peg$c0;\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 34) {\n            s3 = peg$c22;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c23); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c26(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c0;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = [];\n        if (peg$c27.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c28); }\n        }\n        if (s2 !== peg$FAILED) {\n          while (s2 !== peg$FAILED) {\n            s1.push(s2);\n            if (peg$c27.test(input.charAt(peg$currPos))) {\n              s2 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s2 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c28); }\n            }\n          }\n        } else {\n          s1 = peg$c0;\n        }\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c26(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parsenot() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 33) {\n        s1 = peg$c29;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c30); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c2.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c3); }\n        }\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          if (peg$c2.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c3); }\n          }\n        }\n        if (s2 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c31();\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c0;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c0;\n      }\n\n      return s0;\n    }\n\n\n        function strconcat(s) { return s.join(\"\") }\n\n\n    peg$result = peg$startRuleFunction();\n\n    if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n      return peg$result;\n    } else {\n      if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n        peg$fail({ type: \"end\", description: \"end of input\" });\n      }\n\n      throw peg$buildException(null, peg$maxFailExpected, peg$maxFailPos);\n    }\n  }\n\n  return {\n    SyntaxError: SyntaxError,\n    parse:       parse\n  };\n})();\ndefine('peg/query',[],function() { return _query_parser; });\n\n","define('stores/lists',[],function() {\n  var module = {};\n  module.lists = {};\n\n  module.set = function(key, val) {\n    module.lists[key] = val;\n  };\n\n  module.get = function(key) {\n    return module.lists[key];\n  };\n\n  return module;\n});\n\n","define('query',[\n  \"./peg/query\",\n  \"stores/lists\",\n], function(Parser, Lists) {\n  var groupbys = {\n    \"list\": \"idList\",\n    \"state\": \"closed\"\n  };\n  var sortdirs = {\n    \"asc\": function(a, b) {\n      return a.localeCompare(b);\n    },\n    \"desc\": function(a, b) {\n      return b.localeCompare(a);\n    }\n  };\n  return {\n    parse: function(str) {\n      var output = {\n        filters: []\n      };\n      var terms = Parser.parse(str);\n      for (var i = 0; i < terms.length; ++i) {\n        var term = terms[i];\n\n        var field = term.field;\n        var value = term.value;\n        switch (field) {\n          case \"board\":\n            output[field] = value;\n            break;\n          case \"sortdir\":\n            output.compare = sortdirs[value];\n            break;\n          case \"sort\":\n            var sorter;\n            switch (value) {\n              case \"list\":\n                sorter = function(a, b) {\n                  return this.compare(\n                    Lists.get(a.idList).name,\n                    Lists.get(b.idList).name);\n                }.bind(output);\n                break;\n              case \"state\":\n                sorter = function(a, b) {\n                  return this.compare(\n                    a.closed ? \"c\" : \"o\",\n                    b.closed ? \"c\" : \"o\");\n                }.bind(output);\n                break;\n              case \"mod\":\n                sorter = function(a, b) {\n                  return this.compare(a.dateLastActivity, b.dateLastActivity);\n                }.bind(output);\n                break;\n              case \"due\":\n                sorter = function(a, b) {\n                  return this.compare(a.due, b.due);\n                }.bind(output);\n                break;\n            }\n            output.sorter = sorter;\n            break;\n          case \"groupby\":\n            output[field] = groupbys[value] || value;\n            break;\n          case \"title\":\n            term.field = \"name\";\n            output.filters.push(term);\n            break;\n          case \"state\":\n            term.field = \"closed\";\n            if (term.value === \"closed\") {\n              term.value = true;\n              output.filters.push(term);\n            } else if (term.value === \"open\") {\n              term.value = false;\n              output.filters.push(term);\n            } else {\n              console.log(\"Ignoring state filter: \" + term.value);\n            }\n            break;\n        }\n      }\n      if (output.sorter !== undefined && output.compare == undefined) {\n        output.compare = sortdirs.asc;\n      }\n      output.terms = terms;\n      output.str = str;\n      return output;\n    }\n  };\n});\n\n","define('stores/selected',[],function() {\n  var module = {};\n  module.selected = {};\n\n  module.set = function(key, val) {\n    module.selected[key] = val;\n  };\n\n  module.any = function() {\n    for (var key in module.selected) {\n      if (module.selected[key]) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  module.getSelected = function() {\n    var selected = [];\n    // For some reason for..in didn't work here\n    Object.keys(module.selected).forEach(function(key) {\n      if (module.selected[key]) {\n        selected.push(key);\n      }\n    });\n    return selected;\n  };\n\n  return module;\n});\n\n","\ndefine('views/trello_item',[\n  'react',\n  'stores/lists',\n  'stores/selected'\n], function(React, Lists, Selected) {\n\n  return React.createClass({\n    getInitialState: function() {\n      return {\n        checked: false\n      };\n    },\n\n    handleClick: function(event) {\n      if (event.target.tagName !== \"A\") {\n        var newVal = !this.state.checked;\n        this.setState({\n          checked: newVal\n        });\n        Selected.set(this.props.data.id, newVal);\n      }\n    },\n\n    render: function() {\n      return (\n        React.createElement(\"tr\", {className: \"trelloItem\", onClick: this.handleClick}, \n          React.createElement(\"td\", {className: \"checkCol\"}, \n            React.createElement(\"input\", {type: \"checkbox\", checked: this.state.checked, onChange: this.handleClick})\n          ), \n          React.createElement(\"td\", {className: \"titleCol\"}, React.createElement(\"a\", {href: this.props.data.url}, this.props.data.name)), \n          React.createElement(\"td\", {className: \"listCol\"}, Lists.get(this.props.data.idList).name), \n          React.createElement(\"td\", {className: \"stateCol\"}, this.props.data.closed ? \"closed\" : \"open\"), \n          React.createElement(\"td\", {className: \"modCol\"}, this.props.data.dateLastActivity), \n          React.createElement(\"td\", {className: \"dueCol\"}, this.props.data.due)\n        )\n      );\n    }\n  });\n\n});\n\n","\ndefine('views/trello_group',['react', './trello_item'], function(React, TrelloItem) {\n  return React.createClass({\n    render: function() {\n      var rows = this.props.cards.map(function(card) {\n        return (\n          React.createElement(TrelloItem, {key: card.id, data: card})\n        );\n      });\n\n      var heading;\n      if (this.props.group !== null) {\n        heading = React.createElement(\"div\", {className: \"panel-heading\"}, \n                    React.createElement(\"h1\", {className: \"panel-title\"}, this.props.group)\n                  );\n      }\n\n      return (\n        React.createElement(\"div\", {className: \"trelloGroup panel panel-info\"}, \n          heading, \n          React.createElement(\"table\", {className: \"trello table table-striped\"}, \n            React.createElement(\"thead\", null, \n              React.createElement(\"tr\", null, \n                React.createElement(\"th\", {className: \"checkCol\"}, \"\"), \n                React.createElement(\"th\", {className: \"titleCol\"}, \"Title\"), \n                React.createElement(\"th\", {className: \"listCol\"}, \"List\"), \n                React.createElement(\"th\", {className: \"stateCol\"}, \"State\"), \n                React.createElement(\"th\", {className: \"modCol\"}, \"Last modified\"), \n                React.createElement(\"th\", {className: \"dueCol\"}, \"Due\")\n              )\n            ), \n            React.createElement(\"tbody\", null, \n              rows\n            )\n          )\n        )\n      );\n    }\n  });\n});\n\n","\ndefine('views/query_bar',['react', 'query'], function(React, Query) {\n  return React.createClass({\n    getDefaultProps: function() {\n      return {\n        queue: []\n      };\n    },\n    getInitialState: function() {\n      return Query.parse(this.props.defaultQuery);\n    },\n    handleSubmit: function(event) {\n      event.preventDefault();\n      this.updateVal(event.target.getElementsByTagName('input')[0].value);\n    },\n    handleChange: function(event) {\n      if (this.state.timer) {\n        clearTimeout(this.state.timer);\n      }\n      var input = event.target;\n      this.state.timer = setTimeout(function() {\n        this.updateVal(input.value);\n      }.bind(this), 500);\n    },\n    updateVal: function(val) {\n      var state;\n      if (val === \"\") {\n        state = {\n          str: \"\"\n        };\n      } else {\n        try {\n          state = Query.parse(val);\n          var url = window.location.origin + window.location.pathname\n            + '?q=' + encodeURIComponent(val);\n          history.replaceState(null, null, url);\n          localStorage.query = val;\n        } catch ( e ) {\n          if (e.message) {\n            console.log(e);\n            alert(e.message);\n          } else {\n            console.log(e);\n          }\n        }\n      }\n      if (state !== undefined) {\n        this.setState(state);\n        this.props.onUpdate(state);\n      }\n    },\n    render: function() {\n      return (\n        React.createElement(\"h3\", {className: \"page-header\"}, React.createElement(\"form\", {onSubmit: this.handleSubmit}, React.createElement(\"input\", {id: \"queryInput\", type: \"text\", className: \"form-control\", defaultValue: this.state.str, onChange: this.handleChange})))\n      );\n    }\n  });\n});\n\n","\ndefine('views/trello_board',[\n  'react',\n  'trello',\n  'action',\n  'query',\n  'stores/lists',\n  'stores/selected',\n  './trello_group',\n  './query_bar'\n], function(React, Trello, Action, Query, Lists, Selected, TrelloGroup,\n  QueryBar) {\n  return React.createClass({\n    getInitialState: function() {\n      return {\n        response: {\n          cards: []\n        },\n        filtered: [],\n        query: Query.parse(this.props.defaultQuery)\n      };\n    },\n    updateBoard: function(query) {\n      console.log('Updating board with query', query);\n      Trello.boards.get(query.board, {\n        cards: 'all',\n        lists: 'all'\n      }, function(data) {\n        for (var i = 0; i < data.lists.length; i++) {\n          var list = data.lists[i];\n          Lists.set(list.id, list);\n        }\n        this.setState({\n          response: data,\n          filtered: [],\n          query: query\n        });\n      }.bind(this));\n    },\n    componentDidMount: function() {\n      this.updateBoard(this.state.query);\n    },\n\n    updateQuery: function(query) {\n      if (this.state.query.board !== query.board) {\n        this.updateBoard(query);\n      } else {\n        this.state.query = query;\n        this.setState(this.state);\n      }\n    },\n\n    handleActionMenu: function(event) {\n      // If any items are selected, open the context menu\n      if (Selected.any()) {\n        event.preventDefault();\n\n        // Move the context menu to the click position\n        var menu = document.getElementById('context-menu');\n        menu.style.left = JSON.stringify(event.pageX - 100) + 'px';\n        menu.style.top = JSON.stringify(event.pageY - 80) + 'px';\n\n        // Display it\n        if (!menu.classList.contains('open')) {\n          menu.classList.add('open');\n        }\n\n        // Clear the input and move the keyboard focus there\n        var input = document.getElementById('context-menu-input');\n        input.value = \"\";\n        input.focus();\n\n        // Set up an event handle to close the menu on esc key\n        document.onkeydown = function(event) {\n          if (event.keyCode === 27) { // Esc key code\n            this.closeMenu();\n            event.preventDefault();\n          }\n        }.bind(this);\n      }\n    },\n\n    closeMenu: function() {\n      var menu = document.getElementById('context-menu');\n      menu.classList.remove('open');\n      document.onkeydown = null;\n    },\n\n    handleActionSubmit: function(event) {\n      event.preventDefault();\n      var parsed = Action.parse(event.target.getElementsByTagName('input')[0].value);\n      var cardIds = Selected.getSelected();\n      for (var field in parsed.fields) {\n        switch (field) {\n          case \"title\":\n            var newVal = parsed.fields[field];\n            var pending = [];\n            for (var i = 0; i < cardIds.length; ++i) {\n              var cardId = cardIds[i];\n              console.log(cardId, newVal);\n              pending.push(Trello.put('cards/' + cardId + '/name',\n                {\n                  value: newVal\n                }));\n              for (var j = 0; j < this.state.response.cards.length; ++j) {\n                var card = this.state.response.cards[i];\n                if (card.id === cardId) {\n                  card.name = newVal;\n                }\n              }\n            }\n            console.log(pending);\n            // /1/cards/[card id or shortlink]/name\n            break;\n        }\n      }\n      this.setState(this.state);\n      this.closeMenu();\n    },\n\n    render: function() {\n      var grouped = {};\n      var cards = this.state.response.cards;\n      var filters = this.state.query.filters;\n      var groupby = this.state.query.groupby;\n      for (var i = 0; i < cards.length; ++i) {\n        var card = cards[i];\n\n        // Apply the filters\n        var matched = true;\n        for (var j = 0; j < filters.length; ++j) {\n          var filter = filters[j];\n          var fieldVal = card[filter.field];\n          switch (typeof fieldVal) {\n            case \"boolean\":\n              if (filter.op && filter.op.name == \"not\") {\n                matched = matched && fieldVal !== filter.value;\n              } else {\n                matched = matched && fieldVal === filter.value;\n              }\n              break;\n            case \"string\":\n              if (filter.op && filter.op.name == \"not\") {\n                matched = matched && !fieldVal.match(filter.value);\n              } else {\n                matched = matched && fieldVal.match(filter.value);\n              }\n              break;\n          }\n        }\n\n        if (matched) {\n          // Apply the grouping\n          var key = card[groupby] || \"ungrouped\";\n          if (grouped[key] === undefined) {\n            grouped[key] = [card];\n          } else {\n            grouped[key].push(card);\n          }\n        }\n      }\n\n      // Render the groups\n      var sorter = this.state.query.sorter;\n      var groups = [];\n      for (var group in grouped) {\n        var cards = grouped[group];\n        // Apply the sorting\n        if (sorter !== null) {\n          cards.sort(sorter);\n        }\n        var groupName;\n        if (groupby === undefined) {\n          groupName = null;\n        } else {\n          groupName = this.groupName(group);\n        }\n        groups.push(\n          React.createElement(TrelloGroup, {key: group, group: groupName, cards: cards})\n        );\n      }\n\n      return (\n        React.createElement(\"div\", {className: \"container\", onContextMenu: this.handleActionMenu}, \n          React.createElement(QueryBar, {defaultQuery: this.props.defaultQuery, onUpdate: this.updateQuery}), \" \", groups, \n          React.createElement(\"div\", {id: \"context-menu\", className: \"dropdown\"}, \n            React.createElement(\"ul\", {className: \"dropdown-menu\"}, \n              React.createElement(\"li\", null, \n                React.createElement(\"form\", {id: \"action-form\", onSubmit: this.handleActionSubmit}, \n                  React.createElement(\"label\", null, \"Action: \"), \n                  React.createElement(\"input\", {id: \"context-menu-input\", text: \"type\"})\n                )\n              )\n            )\n          )\n        )\n      );\n    },\n\n    groupName: function(group) {\n      switch (this.state.query.groupby) {\n        case \"idList\":\n          var list = Lists.get(group);\n          if (list !== undefined) {\n            return list.name;\n          } else {\n            return \"N/A\";\n          }\n          break;\n        case \"closed\":\n          if (group === \"true\") { // Yep, string true, not bool\n            return \"closed\";\n          } else {\n            return \"open\";\n          }\n          break;\n        default:\n          return group;\n      }\n    }\n  });\n});\n\n","\ndefine('app',['react', './views/trello_board'], function(React, TrelloBoard) {\n  var App = {};\n  App.init = function(query, el) {\n    var el = el || document.body;\n    React.render(React.createElement(TrelloBoard, {defaultQuery: query}), el);\n  };\n\n  return App;\n});\n\n","define('util',{\n  setQueryString: function(qobj) {\n    var pairs = [];\n    for (var key in qobj) {\n      pairs.push(key + \"=\" + qobj[key]);\n    }\n    window.location.search = \"?\" + pairs.join(\"&\");\n  },\n  getQueryString: function() {\n    var kv = window.location.search.substr(1).split('&');\n    if (kv == \"\") return {};\n    var obj = {};\n\n    for (var i = 0; i < kv.length; ++i) {\n      var pair = kv[i].split('=', 2);\n      if (pair.length == 1) {\n        obj[pair[0]] = \"\";\n      } else {\n        obj[pair[0]] = decodeURIComponent(pair[1].replace(/\\+/g, \" \"));\n      }\n    }\n    return obj;\n  }\n});\n\n"]}